<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Vue3 | 小陈小陈，心想事成</title>
    <meta name="description" content="一本正经的学习">
    
    
    <link rel="preload" href="/assets/css/0.styles.9b57bccc.css" as="style"><link rel="preload" href="/assets/js/app.1ae9d9f8.js" as="script"><link rel="preload" href="/assets/js/2.854a77d5.js" as="script"><link rel="preload" href="/assets/js/22.22b3d770.js" as="script"><link rel="prefetch" href="/assets/js/10.117b2710.js"><link rel="prefetch" href="/assets/js/11.62f8bcdd.js"><link rel="prefetch" href="/assets/js/12.fd2bb82d.js"><link rel="prefetch" href="/assets/js/13.72ebf73a.js"><link rel="prefetch" href="/assets/js/14.e479313e.js"><link rel="prefetch" href="/assets/js/15.d7c1ffa3.js"><link rel="prefetch" href="/assets/js/16.8a3dafd4.js"><link rel="prefetch" href="/assets/js/17.6738bee5.js"><link rel="prefetch" href="/assets/js/18.c14cf9c6.js"><link rel="prefetch" href="/assets/js/19.40e5a969.js"><link rel="prefetch" href="/assets/js/20.b20a9aef.js"><link rel="prefetch" href="/assets/js/21.644273f6.js"><link rel="prefetch" href="/assets/js/23.01402885.js"><link rel="prefetch" href="/assets/js/24.895485da.js"><link rel="prefetch" href="/assets/js/25.e364caee.js"><link rel="prefetch" href="/assets/js/26.da31edd3.js"><link rel="prefetch" href="/assets/js/27.59fff129.js"><link rel="prefetch" href="/assets/js/28.46361883.js"><link rel="prefetch" href="/assets/js/29.329d5acb.js"><link rel="prefetch" href="/assets/js/3.8e9d119f.js"><link rel="prefetch" href="/assets/js/30.452b4f31.js"><link rel="prefetch" href="/assets/js/31.d2eee2c2.js"><link rel="prefetch" href="/assets/js/32.bc4e371a.js"><link rel="prefetch" href="/assets/js/33.101f90b2.js"><link rel="prefetch" href="/assets/js/34.ee8fd077.js"><link rel="prefetch" href="/assets/js/35.d8b31fca.js"><link rel="prefetch" href="/assets/js/36.99eb1472.js"><link rel="prefetch" href="/assets/js/37.280958f5.js"><link rel="prefetch" href="/assets/js/38.c226c526.js"><link rel="prefetch" href="/assets/js/39.f275d26b.js"><link rel="prefetch" href="/assets/js/4.ce340b11.js"><link rel="prefetch" href="/assets/js/40.68910ab2.js"><link rel="prefetch" href="/assets/js/41.2c66f197.js"><link rel="prefetch" href="/assets/js/42.4ef930d0.js"><link rel="prefetch" href="/assets/js/43.edeb60a1.js"><link rel="prefetch" href="/assets/js/44.5c5e4fd2.js"><link rel="prefetch" href="/assets/js/45.b0bc7ef8.js"><link rel="prefetch" href="/assets/js/46.8b2aac91.js"><link rel="prefetch" href="/assets/js/47.45469b48.js"><link rel="prefetch" href="/assets/js/48.804fac29.js"><link rel="prefetch" href="/assets/js/5.8b784284.js"><link rel="prefetch" href="/assets/js/6.d5340385.js"><link rel="prefetch" href="/assets/js/7.d6b3c5de.js"><link rel="prefetch" href="/assets/js/8.a4315874.js"><link rel="prefetch" href="/assets/js/9.7c808697.js">
    <link rel="stylesheet" href="/assets/css/0.styles.9b57bccc.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">小陈小陈，心想事成</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">前端</a></div><div class="nav-item"><a href="/nav/Time.html" class="nav-link">时间安排</a></div><div class="nav-item"><a href="/nav/Reading.html" class="nav-link">阅读</a></div><div class="nav-item"><a href="/nav/MY.html" class="nav-link">作品</a></div><div class="nav-item"><a href="https://github.com/jeryqwq" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">前端</a></div><div class="nav-item"><a href="/nav/Time.html" class="nav-link">时间安排</a></div><div class="nav-item"><a href="/nav/Reading.html" class="nav-link">阅读</a></div><div class="nav-item"><a href="/nav/MY.html" class="nav-link">作品</a></div><div class="nav-item"><a href="https://github.com/jeryqwq" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JS深入系列</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>框架必知</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>框架</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/FrameWork/Typescript.html" class="sidebar-link">Typescript</a></li><li><a href="/FrameWork/Vue.html" class="sidebar-link">Vue全家桶进阶</a></li><li><a href="/FrameWork/Vue3.html" class="active sidebar-link">Vue3</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/FrameWork/Vue3.html#关于vue3" class="sidebar-link">关于Vue3</a></li><li class="sidebar-sub-header"><a href="/FrameWork/Vue3.html#核心api" class="sidebar-link">核心API</a></li><li class="sidebar-sub-header"><a href="/FrameWork/Vue3.html#运行" class="sidebar-link">运行</a></li><li class="sidebar-sub-header"><a href="/FrameWork/Vue3.html#核心原理及实现" class="sidebar-link">核心原理及实现</a></li><li class="sidebar-sub-header"><a href="/FrameWork/Vue3.html#vue-composition-api" class="sidebar-link">@vue/composition-api</a></li><li class="sidebar-sub-header"><a href="/FrameWork/Vue3.html#构建一个todosapp" class="sidebar-link">构建一个todosAPP</a></li><li class="sidebar-sub-header"><a href="/FrameWork/Vue3.html#变化" class="sidebar-link">变化</a></li></ul></li><li><a href="/FrameWork/React.html" class="sidebar-link">React</a></li><li><a href="/FrameWork/ReactHooks.html" class="sidebar-link">ReactHooks</a></li><li><a href="/FrameWork/Koa.html" class="sidebar-link">Koa</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据库</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端大杂烩</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>三大浪漫</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="关于vue3"><a href="#关于vue3" class="header-anchor">#</a> 关于Vue3</h2> <p>Vue3与10月6号左右宣布即将发布，作者也公开了底层的基于proxy语法重新构建的vue3新版本，大量使用了typescript去构建，rollup打包，风格也借鉴了react 15.8版本的hooks，相当于vue3中没有了this对象(use,mixin等基于this的API可能有改变,router和vuex也将基于inject,provid API重写--猜测)，底层响应式原理重写(delete,set等由于defineprototypeAPI的缺点产生的API也将没有)，Vue3相关的API可以看这里<a href="https://vue-composition-api-rfc.netlify.com/api.html#setup" target="_blank" rel="noopener noreferrer">Vue Composition API<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>目前还没出中文版本，熟悉react hooks的可直接上手。个人还是更期待react17.x后的concurrent模式带来的提升，hooks也早已是react提出已久的编程思想了。</p> <h2 id="核心api"><a href="#核心api" class="header-anchor">#</a> 核心API</h2> <h3 id="reactive"><a href="#reactive" class="header-anchor">#</a> reactive</h3> <p>响应式核心，相关核心API依赖，使用proxy代理对象并返回proxy，相当于Vue2的definePropertyAPI，避免了数组的缺陷，可劫持数据的所有操作，具体查看相关API文档</p> <h3 id="effect"><a href="#effect" class="header-anchor">#</a> effect</h3> <p>与react的useEffect用法相识，当前先触发一次，之后对数据的更改都会执行该函数，仅对所传递的函数内有响应式的数据生效，且只有函数内的变量状态改变才触发，依赖收集很巧妙的利用JS单线程的特点，极大程度上自动优化了框架性能，使用者不必太关心性能问题。</p> <h2 id="运行"><a href="#运行" class="header-anchor">#</a> 运行</h2> <p>打包一份vue3的代码，试试效果</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype">&lt;!DOCTYPE html&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>X-UA-Compatible<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>ie=edge<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>./vue.global.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- vue仓库打包的代码 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
        <span class="token keyword">let</span> obj1<span class="token operator">=</span><span class="token punctuation">{</span>
            name<span class="token operator">:</span><span class="token string">'CJ'</span><span class="token punctuation">,</span>
            age<span class="token operator">:</span><span class="token number">23</span>
        <span class="token punctuation">}</span><span class="token comment">//原对象</span>
        <span class="token keyword">let</span> p1<span class="token operator">=</span>Vue<span class="token punctuation">.</span><span class="token function">reactive</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//返回代理后的proxy对象</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//Proxy{name:&quot;CJ}</span>
        Vue<span class="token punctuation">.</span><span class="token function">effect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token comment">//影响：当p1的name属性发生改变时触发函数执行，仅仅只有name属性更改触发</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;effect1:name改变&quot;</span><span class="token operator">+</span>p1<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token comment">//立即执行一次 打印effect1:name改变CJ</span>

        Vue<span class="token punctuation">.</span><span class="token function">effect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token comment">//同上</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;effect2:name改变&quot;</span><span class="token operator">+</span>p1<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token comment">//立即执行一次 打印effect2:name改变CJ</span>
        Vue<span class="token punctuation">.</span><span class="token function">effect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token comment">//影响：当p1的age属性发生改变时触发函数执行，仅仅只有age属性更改触发</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;effect1:age改变&quot;</span><span class="token operator">+</span>p1<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token comment">//立即执行一次 打印effect1:age改变23</span>
        Vue<span class="token punctuation">.</span><span class="token function">effect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token comment">//同上</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;effect2:age改变&quot;</span><span class="token operator">+</span>p1<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token comment">//立即执行一次  打印effect2:age改变23</span>

        p1<span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token string">&quot;CJI@&quot;</span><span class="token punctuation">;</span><span class="token comment">//name属性有两个effect函数，所以执行两次</span>
        <span class="token comment">// effect1:name改变CJI@</span>
        <span class="token comment">// effect2:name改变CJI@</span>
        p1<span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token string">&quot;CJI1&quot;</span><span class="token punctuation">;</span><span class="token comment">//同理</span>
        <span class="token comment">// effect1:name改变CJI1</span>
        <span class="token comment">// effect2:name改变CJI1</span>
        p1<span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token string">&quot;CJI2&quot;</span><span class="token punctuation">;</span><span class="token comment">//同理</span>
        p1<span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token string">&quot;CJI3&quot;</span><span class="token punctuation">;</span><span class="token comment">//同理</span>
        p1<span class="token punctuation">.</span>age<span class="token operator">=</span><span class="token number">24</span><span class="token punctuation">;</span><span class="token comment">//age更改也有两个effect，也是两次。</span>
         <span class="token comment">// 控制台结果</span>
        <span class="token comment">// effect1:age改变24</span>
        <span class="token comment">// effect2:age改变24</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>


</code></pre></div><p>开始感觉真的很奇怪，vue3是如何做到effect内的函数仅因为自己函数内有的变量改动才会触发执行，感觉好神奇，每次依赖收集都能收集如此颗粒化。</p> <h2 id="核心原理及实现"><a href="#核心原理及实现" class="header-anchor">#</a> 核心原理及实现</h2> <p>使用typescript构建，刚学，比较菜，就当原生JS看就好了</p> <h3 id="reactive-ts"><a href="#reactive-ts" class="header-anchor">#</a> reactive.ts</h3> <p>源码路径：vue-next\packages\reactivity\src\reactive.ts</p> <p>将数据转换为响应式，使用proxy代理对应的target，劫持对应的get，set，weakMap做代理映射表，基于其弱引用的特性，key只能为Object类型，对象不存在时GC自动回收其value，性能优化。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">let</span> <span class="token punctuation">{</span>track<span class="token punctuation">,</span>trigger<span class="token punctuation">}</span><span class="token operator">=</span><span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">'./track'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//触发器和收集依赖</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>proxyConstructor<span class="token punctuation">,</span>Handle<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./interface'</span><span class="token punctuation">;</span><span class="token comment">//ts接口，类型约束handler和proxy</span>
<span class="token keyword">let</span> toProxy<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">WeakMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//存储代理对象弱引用，key只能为非简单类型，key为空时方便GC机制回收对用的value</span>
<span class="token keyword">let</span> toRaw<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">WeakMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//防止重复代理已经代理过的proxy对象做缓存检查</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token operator">:</span><span class="token builtin">any</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//就是想和源码一样的调用过程而已</span>
    <span class="token keyword">return</span> <span class="token function">createReactiveObj</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> handle<span class="token operator">:</span>Handle<span class="token operator">=</span><span class="token punctuation">{</span><span class="token comment">//proxy处理函数，new proxy传入处理器，建议先跳到createReactiveObj方法</span>
    <span class="token keyword">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span>key<span class="token punctuation">,</span>receiver<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">track</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span>key<span class="token punctuation">)</span><span class="token comment">//effect内包裹的函数每次先执行都会获取内部被劫持变量</span>
        <span class="token comment">//触发对应的get，执行依赖收集</span>
        <span class="token keyword">const</span> res<span class="token operator">=</span>Reflect<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span>key<span class="token punctuation">,</span>receiver<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//Reflect能返回操作是否成功</span>
        <span class="token keyword">return</span> res<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span>key<span class="token punctuation">,</span>val<span class="token punctuation">,</span>receiver<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">let</span> res<span class="token operator">:</span><span class="token builtin">boolean</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> oldVal<span class="token operator">=</span>target<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>target<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//没有属性为新增</span>
        <span class="token comment">//防止劫持对象为数组时触发两次set避免不必要的更新</span>
        <span class="token comment">//第一次改变为设置该数组的下标，如果是删除或者新增是则会触发该数组第项的length对象的改变</span>
            <span class="token function">trigger</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span><span class="token string">'add'</span><span class="token punctuation">,</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//通知触发器执行对应的依赖</span>
            res<span class="token operator">=</span>Reflect<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span>key<span class="token punctuation">,</span>val<span class="token punctuation">,</span>receiver<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//使用reflect能够返回操作是否成功</span>
            <span class="token keyword">return</span> res<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>oldVal<span class="token operator">!==</span>val<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//对象已有改属性代表修改</span>
            res<span class="token operator">=</span>Reflect<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span>key<span class="token punctuation">,</span>val<span class="token punctuation">,</span>receiver<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">trigger</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span><span class="token string">'update'</span><span class="token punctuation">,</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//通知触发器执行对应的依赖</span>
            <span class="token keyword">return</span> res<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">deleteProperty</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span>key</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> Reflect<span class="token punctuation">.</span><span class="token function">deleteProperty</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span>key<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//代理监测</span>
<span class="token keyword">function</span> createReactiveObj<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name">Object</span> <span class="token operator">&gt;</span><span class="token punctuation">(</span>target<span class="token operator">:</span><span class="token constant">T</span><span class="token operator">|</span><span class="token builtin">any</span><span class="token punctuation">)</span><span class="token operator">:</span>proxyConstructor<span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> target<span class="token operator">===</span><span class="token string">'object'</span><span class="token operator">||</span>target<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//type of null ===object===true</span>
        <span class="token keyword">const</span> targetProxy<span class="token operator">=</span>toProxy<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token comment">//代理映射表弱引用，查看是否以及被代理过</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>targetProxy<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//防止代理重复的代理对象</span>
            <span class="token keyword">return</span> targetProxy<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>toRaw<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//反向映射表防止传入多次代理已代理过的对象</span>
            <span class="token keyword">return</span> target
        <span class="token punctuation">}</span>
        <span class="token keyword">let</span> observe<span class="token operator">:</span>proxyConstructor<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span>handle<span class="token punctuation">)</span><span class="token punctuation">;</span>
        toProxy<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span>observe<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//添加代理映射表</span>
        toRaw<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span>observe<span class="token punctuation">,</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//添加反向代理映射表</span>
        <span class="token keyword">return</span> observe<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> target<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="track-ts"><a href="#track-ts" class="header-anchor">#</a> track.ts</h4> <p>effect函数收集监听对象effect里target对应的函数，利用执行函数时会访问到函数内监听对象的值，触发handler的get，执行收集依赖，相同的key放入同一个set集合,改变时在set函数内触发对应key的set集合的函数依次执行</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> <span class="token punctuation">{</span>effectStacks<span class="token punctuation">}</span><span class="token operator">=</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./effect'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//存储effect函数的栈接口数组</span>
<span class="token keyword">let</span> targetMap<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">WeakMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">track</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span>key</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//收集依赖</span>
    <span class="token keyword">let</span> effect<span class="token operator">=</span>effectStacks<span class="token punctuation">[</span>effectStacks<span class="token punctuation">.</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//得到effect内的函数</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>effect<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">let</span> depsMap<span class="token operator">=</span>targetMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//查看是否有该对象map</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>depsMap<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//没有则新建对应target的map对象</span>
            targetMap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span>depsMap<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">let</span> deps<span class="token operator">=</span>depsMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//得到该map下的所收集的set集合的依赖</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>deps<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//没有则新建空set</span>
            depsMap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span>deps<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>deps<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>effect<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//没有effect则添加</span>
            deps<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>effect<span class="token punctuation">)</span><span class="token punctuation">;</span> 
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token comment">//函数执行一遍后targetMap内的结构就应该是这样的解构</span>
<span class="token comment">// {</span>
<span class="token comment">//     target:{</span>
<span class="token comment">//         key:[effect1,effect2,effect3]//,</span>
<span class="token comment">//         key:[effect1]</span>
<span class="token comment">//     },</span>
<span class="token comment">//     target2:{</span>
<span class="token comment">//         key:[effect1,effect2,effect3]//,</span>
<span class="token comment">//         key:[effect1]</span>
<span class="token comment">//     }</span>
<span class="token comment">// }</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">trigger</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span>type<span class="token punctuation">,</span>key</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//触发依赖执行</span>
    <span class="token keyword">let</span> depsMap<span class="token operator">=</span>targetMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//获取对象下的map</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>depsMap<span class="token punctuation">)</span><span class="token punctuation">{</span>

    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span><span class="token comment">//有map的话就代表该map下有set集合的effect函数</span>
        <span class="token keyword">let</span> deps<span class="token operator">=</span>depsMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//是否有该key的effect set集合</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>deps<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//有就遍历整个set对象执行对应的effect内的函数</span>
            deps<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">fn</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> 
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h4 id="effect-ts"><a href="#effect-ts" class="header-anchor">#</a> effect.ts</h4> <p>存储effect栈数组，每次effect函数调用时都会往effect栈数组推入依赖的函数，然后执行一次effect内包裹的函数去触发proxy的get，再去触发收集依赖，以特定的格式收集存储该依赖，执行完毕后移除push的effect函数。</p> <div class="language-ts extra-class"><pre class="language-ts"><code> <span class="token keyword">let</span> effectStacks<span class="token operator">:</span><span class="token builtin">Array</span><span class="token operator">&lt;</span><span class="token builtin">Function</span><span class="token operator">&gt;=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
 <span class="token keyword">function</span> <span class="token function">createReactiveEffect</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token operator">:</span><span class="token builtin">Function</span></span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token keyword">void</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token function-variable function">effect</span> <span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">run</span><span class="token punctuation">(</span>effect<span class="token punctuation">,</span>fn<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
     <span class="token function">effect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">run</span> <span class="token punctuation">(</span><span class="token parameter">effect<span class="token operator">:</span><span class="token builtin">Function</span><span class="token punctuation">,</span>fn<span class="token operator">:</span><span class="token builtin">Function</span></span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token keyword">void</span><span class="token punctuation">{</span>
    <span class="token keyword">try</span><span class="token punctuation">{</span>
        effectStacks<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>effect<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//effect栈推入effect函数</span>
        <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//首次调用，执行一次，触发get函数内的track收集依赖，此时的栈内已有effect函数。</span>
        <span class="token comment">//track会将该函数已特定的形式存储起来</span>
    <span class="token punctuation">}</span><span class="token keyword">finally</span><span class="token punctuation">{</span>
        effectStacks<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//删除push的effect，等待下次effect调用该函数，再次重新执行</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
 
 <span class="token keyword">function</span> <span class="token function">effect</span> <span class="token punctuation">(</span><span class="token parameter">fn<span class="token operator">:</span><span class="token builtin">Function</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">createReactiveEffect</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span>
    effectStacks<span class="token punctuation">,</span>
    effect
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="效果"><a href="#效果" class="header-anchor">#</a> 效果</h3> <p>因为环境是ts构建，所以使用node去执行对应的代码</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>reactive<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./reactive'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>effect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./effect'</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> obj1<span class="token operator">=</span><span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token string">'CJ'</span><span class="token punctuation">}</span>
<span class="token keyword">let</span> p1<span class="token operator">=</span><span class="token function">reactive</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">effect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;effect1:&quot;</span><span class="token operator">+</span>p1<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">effect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;effect2:&quot;</span><span class="token operator">+</span>p1<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
p1<span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token string">&quot;CJI@&quot;</span><span class="token punctuation">;</span>
p1<span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token string">&quot;CJI1&quot;</span><span class="token punctuation">;</span>
p1<span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token string">&quot;CJI2&quot;</span><span class="token punctuation">;</span>
p1<span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token string">&quot;CJI3&quot;</span><span class="token punctuation">;</span>
<span class="token comment">//输出顺序</span>
<span class="token comment">// effect1:CJ name effect1 首次执行</span>
<span class="token comment">// effect2:CJ name effect2首次执行</span>
<span class="token comment">// effect1:CJI@  name  effect1 修改触发</span>
<span class="token comment">// effect2:CJI@  name  effect2 修改触发</span>
<span class="token comment">// effect1:CJI1   name  effect1 修改触发</span>
<span class="token comment">// effect2:CJI1</span>
<span class="token comment">// effect1:CJI2</span>
<span class="token comment">// effect2:CJI2</span>
<span class="token comment">// effect1:CJI3</span>
<span class="token comment">// effect2:CJI3</span>


</code></pre></div><h3 id="效果-2"><a href="#效果-2" class="header-anchor">#</a> 效果</h3> <p>使用node去执行对应的代码</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>reactive<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./reactive'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>effect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./effect'</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> obj1<span class="token operator">=</span><span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token string">'CJ'</span><span class="token punctuation">}</span>
<span class="token keyword">let</span> p1<span class="token operator">=</span><span class="token function">reactive</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">effect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;effect1:&quot;</span><span class="token operator">+</span>p1<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">effect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;effect2:&quot;</span><span class="token operator">+</span>p1<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
p1<span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token string">&quot;CJI@&quot;</span><span class="token punctuation">;</span>
p1<span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token string">&quot;CJI1&quot;</span><span class="token punctuation">;</span>
p1<span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token string">&quot;CJI2&quot;</span><span class="token punctuation">;</span>
p1<span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token string">&quot;CJI3&quot;</span><span class="token punctuation">;</span>
<span class="token comment">//输出顺序</span>
<span class="token comment">// effect1:CJ name effect1 首次执行</span>
<span class="token comment">// effect2:CJ name effect2首次执行</span>
<span class="token comment">// effect1:CJI@  name  effect1 修改触发</span>
<span class="token comment">// effect2:CJI@  name  effect2 修改触发</span>
<span class="token comment">// effect1:CJI1   name  effect1 修改触发</span>
<span class="token comment">// effect2:CJI1</span>
<span class="token comment">// effect1:CJI2</span>
<span class="token comment">// effect2:CJI2</span>
<span class="token comment">// effect1:CJI3</span>
<span class="token comment">// effect2:CJI3</span>
</code></pre></div><h2 id="vue-composition-api"><a href="#vue-composition-api" class="header-anchor">#</a> @vue/composition-api</h2> <p>从国庆节到现在还没听说vue3要彻底发布的消息，每天都迫不及待，终于在好奇心的驱使下去研究了一波composition-api的玩法，目前还没正式出vue3，在vue2项目中想要体验vue3的特性时需引入<a href="https://vue-composition-api-rfc.netlify.com/api.html#setup" target="_blank" rel="noopener noreferrer">@vue/composition-api<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="vue-cli3中使用vue-composition-api"><a href="#vue-cli3中使用vue-composition-api" class="header-anchor">#</a> vue/cli3中使用vue/composition-api</h3> <p>初始化cli3项目就不多说了，直接甩命令</p> <div class="language-BASH extra-class"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> -g @vue/cli
<span class="token comment"># OR</span>
<span class="token function">yarn</span> global <span class="token function">add</span> @vue/cli

vue create vue3
<span class="token comment">#创建项目</span>

<span class="token builtin class-name">cd</span> vue3
<span class="token comment">#进入目录</span>

<span class="token function">yarn</span> <span class="token function">install</span>
<span class="token comment">#安装依赖</span>

<span class="token function">npm</span> run serve
<span class="token comment">#开启服务</span>

</code></pre></div><p>一个cli3的基础服务就跑好了，为了能使我们使用vue3的特性，接下来开始安装composition-api</p> <div class="language-BASH extra-class"><pre class="language-bash"><code>
<span class="token function">yarn</span> <span class="token function">add</span> @vue/composition-api

</code></pre></div><p>安装后我们需要在vue项目中使用，需要引入@vue/composition-api，并使用vue的use 来安装</p> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./App.vue'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> VueComponistionApi <span class="token keyword">from</span> <span class="token string">'@vue/composition-api'</span><span class="token punctuation">;</span><span class="token comment">//引入composition-api</span>
Vue<span class="token punctuation">.</span>config<span class="token punctuation">.</span>productionTip <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>VueComponistionApi<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//安装插件</span>
<span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">render</span><span class="token operator">:</span> <span class="token parameter">h</span> <span class="token operator">=&gt;</span> <span class="token function">h</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">$mount</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


</code></pre></div><p>接下来就能快乐的玩耍vue3的新特性了，首先来看看vue单文件结构的变化。</p> <h2 id="构建一个todosapp"><a href="#构建一个todosapp" class="header-anchor">#</a> 构建一个todosAPP</h2> <p>接下来我们来使用composition-api构建一个简单的todosAPP吧！！！</p> <h3 id="v1"><a href="#v1" class="header-anchor">#</a> V1</h3> <p>App.vue</p> <div class="language-html extra-class"><pre class="language-html"><code>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>app<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>state.value<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>addItem<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>点击增加<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>(item, idx) in state.todos<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>idx<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        {{ item.name }}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">float</span><span class="token punctuation">:</span>right</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>finishItem(idx)<span class="token punctuation">&quot;</span></span>
          <span class="token punctuation">&gt;</span></span>是否完成：{{ item.isFinished ? &quot;是&quot; : &quot;否&quot; }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span>
        <span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> reactive<span class="token punctuation">,</span> onMounted <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@vue/composition-api&quot;</span><span class="token punctuation">;</span><span class="token comment">//引入composition-api</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//所有生命周期或者函数API等都在setUp中</span>
    <span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token comment">//渲染完成，对应vue2mounted</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;mounted!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token comment">//将数据转换为响应式</span>
      todos<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      value<span class="token operator">:</span><span class="token string">''</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token function-variable function">addItem</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token comment">//添加代办项</span>
    state<span class="token punctuation">.</span>todos<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      isFinished<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span>
      name<span class="token operator">:</span>state<span class="token punctuation">.</span>value
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    state<span class="token punctuation">.</span>value<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> <span class="token function-variable function">finishItem</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token parameter">idx</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token comment">//完成代办</span>
    state<span class="token punctuation">.</span>todos<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">.</span>isFinished<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">//return的元素可以直接在template中取到，可返回需要的函数和state对象</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      state<span class="token punctuation">,</span>
      addItem<span class="token punctuation">,</span>
      finishItem
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
<span class="token selector">#app</span> <span class="token punctuation">{</span>
  <span class="token property">font-family</span><span class="token punctuation">:</span> <span class="token string">&quot;Avenir&quot;</span><span class="token punctuation">,</span> Helvetica<span class="token punctuation">,</span> Arial<span class="token punctuation">,</span> sans-serif<span class="token punctuation">;</span>
  <span class="token property">-webkit-font-smoothing</span><span class="token punctuation">:</span> antialiased<span class="token punctuation">;</span>
  <span class="token property">-moz-osx-font-smoothing</span><span class="token punctuation">:</span> grayscale<span class="token punctuation">;</span>
  <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #2c3e50<span class="token punctuation">;</span>
  <span class="token property">margin-top</span><span class="token punctuation">:</span> 60px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>


</code></pre></div><p>这样一个简单的todosAPP就完成了，是不是总感觉和vue2有点相识，不是传说中vue3可以抽离逻辑代码吗，接下来我们修改一些代码，将我们的业务抽离出去</p> <h3 id="v2"><a href="#v2" class="header-anchor">#</a> V2</h3> <div class="language-html extra-class"><pre class="language-html"><code>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>app<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>state.value<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>addItem<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>点击增加<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>(item, idx) in state.todos<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>idx<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        {{ item.name }}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">float</span><span class="token punctuation">:</span>right</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>finishItem(idx)<span class="token punctuation">&quot;</span></span>
          <span class="token punctuation">&gt;</span></span>是否完成：{{ item.isFinished ? &quot;是&quot; : &quot;否&quot; }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span>
        <span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> reactive<span class="token punctuation">,</span> onMounted <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@vue/composition-api&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">useTodos</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token comment">//将业务抽成函数并返回业务需要的状态和函数</span>
  <span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;mounted!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    todos<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    value<span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token function-variable function">addItem</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    state<span class="token punctuation">.</span>todos<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      isFinished<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      name<span class="token operator">:</span> state<span class="token punctuation">.</span>value
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    state<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token function-variable function">finishItem</span> <span class="token operator">=</span> <span class="token parameter">idx</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    state<span class="token punctuation">.</span>todos<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">.</span>isFinished <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token comment">//返回状态</span>
    state<span class="token punctuation">,</span>
    addItem<span class="token punctuation">,</span>
    finishItem
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">,</span>content</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span>content<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token comment">//必须返回视图层需要调用到的函数或者对象</span>
      <span class="token operator">...</span><span class="token function">useTodos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token comment">// ...useOthers()</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
<span class="token selector">#app</span> <span class="token punctuation">{</span>
  <span class="token property">font-family</span><span class="token punctuation">:</span> <span class="token string">&quot;Avenir&quot;</span><span class="token punctuation">,</span> Helvetica<span class="token punctuation">,</span> Arial<span class="token punctuation">,</span> sans-serif<span class="token punctuation">;</span>
  <span class="token property">-webkit-font-smoothing</span><span class="token punctuation">:</span> antialiased<span class="token punctuation">;</span>
  <span class="token property">-moz-osx-font-smoothing</span><span class="token punctuation">:</span> grayscale<span class="token punctuation">;</span>
  <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #2c3e50<span class="token punctuation">;</span>
  <span class="token property">margin-top</span><span class="token punctuation">:</span> 60px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>


</code></pre></div><h3 id="props以及content"><a href="#props以及content" class="header-anchor">#</a> props以及content</h3> <ul><li>props的接收方式变了，vue2使用props对象来定义值的类型和默认值，vue3的props传递在setup函数的第一个参数</li> <li>this没了，vue2中所有关于组件的状态都挂载在this对象下，vue3中setup函数的第二个参数传递的this对象</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">,</span>content</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//props和this</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token comment">//</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token comment">//必须返回视图层需要调用到的函数或者对象</span>
      <span class="token operator">...</span><span class="token function">useTodos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token comment">// ...useOthers()</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="变化"><a href="#变化" class="header-anchor">#</a> 变化</h2> <p>个人感觉总体没什么变化，以前很多旧的概念和API都能直接使用，如果真要说变化的地方，就像是作者说的那样，底层性能和虚拟DOM的优化等，有兴趣可以网上看看，对于开发者而言，能抽离业务逻辑好处真的太多太多了，而且也更大的扩展的vue的编码方式，自由度也更大了，周末快乐，做饭去了</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/FrameWork/Vue.html" class="prev">Vue全家桶进阶</a></span> <span class="next"><a href="/FrameWork/React.html">React</a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.1ae9d9f8.js" defer></script><script src="/assets/js/2.854a77d5.js" defer></script><script src="/assets/js/22.22b3d770.js" defer></script>
  </body>
</html>
